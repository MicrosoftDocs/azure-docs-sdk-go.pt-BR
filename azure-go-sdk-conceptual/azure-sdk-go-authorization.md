---
title: Autenticação com o SDK do Azure para Go
description: Saiba mais sobre os métodos de autenticação disponíveis no SDK do Azure para Go e como usá-los.
services: azure
author: sptramer
ms.author: sttramer
manager: carmonm
ms.date: 09/05/2018
ms.topic: conceptual
ms.technology: azure-sdk-go
ms.devlang: go
ms.subservice: authentication
ms.openlocfilehash: c66d6e65f36586bbe5b030cc3b783057b39668db
ms.sourcegitcommit: be967d413a8bf906470e65a97e61688faa9dd98a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/26/2019
ms.locfileid: "55071143"
---
# <a name="authentication-methods-in-the-azure-sdk-for-go"></a><span data-ttu-id="79950-103">Métodos de autenticação no SDK do Azure para Go</span><span class="sxs-lookup"><span data-stu-id="79950-103">Authentication methods in the Azure SDK for Go</span></span>

<span data-ttu-id="79950-104">O SDK do Azure para linguagem Go oferece várias maneiras de se autenticar no Azure.</span><span class="sxs-lookup"><span data-stu-id="79950-104">The Azure SDK for Go offers multiple ways to authenticate with Azure.</span></span> <span data-ttu-id="79950-105">Esses _tipos_ de autenticação são invocados por meio de diferentes _métodos_ de autenticação.</span><span class="sxs-lookup"><span data-stu-id="79950-105">These authentication _types_ are invoked through different authentication _methods_.</span></span> <span data-ttu-id="79950-106">Este artigo aborda os tipos e métodos disponíveis e como escolher quais são ideais para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="79950-106">This article covers the available types, methods, and how to choose which are best for your application.</span></span>

## <a name="available-authentication-types-and-methods"></a><span data-ttu-id="79950-107">Métodos e tipos de autenticação disponíveis</span><span class="sxs-lookup"><span data-stu-id="79950-107">Available authentication types and methods</span></span>

<span data-ttu-id="79950-108">O SDK do Azure para Go oferece vários tipos diferentes de autenticação, usando conjuntos de credenciais diferentes.</span><span class="sxs-lookup"><span data-stu-id="79950-108">The Azure SDK for Go offers several different types of authentication, using different credentials sets.</span></span> <span data-ttu-id="79950-109">Cada tipo de autenticação está disponível por métodos de autenticação diferentes, que são como o SDK usa essas credenciais como entrada.</span><span class="sxs-lookup"><span data-stu-id="79950-109">Each authentication type is available through different authentication methods, which are how the SDK takes these credentials as input.</span></span> <span data-ttu-id="79950-110">A tabela a seguir descreve os tipos disponíveis de autenticação e as situações em que eles são recomendados para uso pelo seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="79950-110">The following table describes the available types of authentication and situations in which they're recommended for use by your application.</span></span>

| <span data-ttu-id="79950-111">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="79950-111">Authentication type</span></span> | <span data-ttu-id="79950-112">Recomendado quando...</span><span class="sxs-lookup"><span data-stu-id="79950-112">Recommended when...</span></span> |
|---------------------|---------------------|
| <span data-ttu-id="79950-113">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="79950-113">Certificate-based authentication</span></span> | <span data-ttu-id="79950-114">Você tem um certificado X509 que foi configurado para um usuário do Azure Active Directory (AAD) ou uma entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="79950-114">You have an X509 certificate that was configured for an Azure Active Directory (AAD) user or service principal.</span></span> <span data-ttu-id="79950-115">Para saber mais, consulte [Introdução à autenticação baseada em certificado no Azure Active Directory].</span><span class="sxs-lookup"><span data-stu-id="79950-115">To learn more, see [Get started with certificate-based authentication in Azure Active Directory].</span></span> |
| <span data-ttu-id="79950-116">Credenciais do cliente</span><span class="sxs-lookup"><span data-stu-id="79950-116">Client credentials</span></span> | <span data-ttu-id="79950-117">Você tem uma entidade de serviço configurada que está definida para esse aplicativo ou para uma classe de aplicativos à qual ele pertence.</span><span class="sxs-lookup"><span data-stu-id="79950-117">You have a configured service principal that is set up for this application or a class of applications it belongs to.</span></span> <span data-ttu-id="79950-118">Para saber mais, consulte [Criar uma entidade de serviço com a CLI do Azure].</span><span class="sxs-lookup"><span data-stu-id="79950-118">To learn more, see [Create a service principal with Azure CLI].</span></span> |
| <span data-ttu-id="79950-119">Identidades gerenciadas dos recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="79950-119">Managed identities for Azure resources</span></span> | <span data-ttu-id="79950-120">O aplicativo está em execução em um recurso do Azure que foi configurado com uma identidade gerenciada.</span><span class="sxs-lookup"><span data-stu-id="79950-120">Your application is running on an Azure resource that has been configured with a managed identity.</span></span> <span data-ttu-id="79950-121">Para saber mais, confira [Identidades gerenciadas para os recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="79950-121">To learn more, see [Managed identities for Azure resources].</span></span> |
| <span data-ttu-id="79950-122">Token de dispositivo</span><span class="sxs-lookup"><span data-stu-id="79950-122">Device token</span></span> | <span data-ttu-id="79950-123">Seu aplicativo foi projetado para ser usado interativamente __apenas__.</span><span class="sxs-lookup"><span data-stu-id="79950-123">Your application is meant to be used interactively __only__.</span></span> <span data-ttu-id="79950-124">Os usuários podem ter a autenticação multifator habilitada.</span><span class="sxs-lookup"><span data-stu-id="79950-124">Users may have multi-factor authentication enabled.</span></span> <span data-ttu-id="79950-125">Os usuários têm acesso a um navegador da Web para fazer entrar.</span><span class="sxs-lookup"><span data-stu-id="79950-125">Users have access to a web browser to sign in.</span></span> <span data-ttu-id="79950-126">Para obter mais informações, consulte [Usar a autenticação de token do dispositivo](#use-device-token-authentication).</span><span class="sxs-lookup"><span data-stu-id="79950-126">For more information, see [Use device token authentication](#use-device-token-authentication).</span></span>|
| <span data-ttu-id="79950-127">Nome de usuário/senha</span><span class="sxs-lookup"><span data-stu-id="79950-127">Username/password</span></span> | <span data-ttu-id="79950-128">Você tem um aplicativo interativo que não pode usar outros métodos de autenticação.</span><span class="sxs-lookup"><span data-stu-id="79950-128">You have an interactive application that can't use any other authentication method.</span></span> <span data-ttu-id="79950-129">Os usuários não têm a autenticação multifator habilitada para entrar no AAD.</span><span class="sxs-lookup"><span data-stu-id="79950-129">Your users don't have multi-factor authentication enabled for their AAD sign-in.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="79950-130">Se você usar um tipo de autenticação que não sejam as credenciais do cliente, seu aplicativo deve estar registrado no Active Directory do Azure.</span><span class="sxs-lookup"><span data-stu-id="79950-130">If you use an authentication type other than client credentials, your application must be registered in Azure Active Directory.</span></span> <span data-ttu-id="79950-131">Para saber mais, [Integrando aplicativos com o Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="79950-131">To learn how, see [Integrating applications with Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span></span>
>
> [!NOTE]
> <span data-ttu-id="79950-132">A menos que você tenha requisitos especiais, evite a autenticação de nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="79950-132">Unless you have special requirements, avoid username/password authentication.</span></span> <span data-ttu-id="79950-133">Em situações em que a entrada baseada em usuário for apropriada, pode ser usada a autenticação de token do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="79950-133">In situations where user-based sign in is appropriate, device token authentication can usually be used instead.</span></span>

[Introdução à autenticação baseada em certificado no Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Get started with certificate-based authentication in Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Criar uma entidade de serviço com a CLI do Azure]: /cli/azure/create-an-azure-service-principal-azure-cli
[Create a service principal with Azure CLI]: /cli/azure/create-an-azure-service-principal-azure-cli
[Identidades gerenciadas para os recursos do Azure]: /azure/active-directory/managed-identities-azure-resources/overview
[Managed identities for Azure resources]: /azure/active-directory/managed-identities-azure-resources/overview

<span data-ttu-id="79950-137">Esses tipos de autenticação estão disponíveis por meio de métodos diferentes.</span><span class="sxs-lookup"><span data-stu-id="79950-137">These authentication types are available through different methods.</span></span>

* <span data-ttu-id="79950-138">A [_Autenticação baseada em ambiente_](#use-environment-based-authentication) lê credenciais diretamente do ambiente do programa.</span><span class="sxs-lookup"><span data-stu-id="79950-138">[_Environment-based authentication_](#use-environment-based-authentication) reads credentials directly from the program's environment.</span></span>
* <span data-ttu-id="79950-139">A [_Autenticação baseada em arquivo_](#use-file-based-authentication) carrega um arquivo contendo as credenciais de entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="79950-139">[_File-based authentication_](#use-file-based-authentication) loads a file containing service principal credentials.</span></span>
* <span data-ttu-id="79950-140">A [_Autenticação baseada em cliente_](#use-an-authentication-client) usa um objeto em código e torna você responsável por fornecer as credenciais durante a execução do programa.</span><span class="sxs-lookup"><span data-stu-id="79950-140">[_Client-based authentication_](#use-an-authentication-client) uses an object in code and makes you responsible for providing the credentials during program execution.</span></span>
* <span data-ttu-id="79950-141">A [_Autenticação de token do dispositivo_](#use-device-token-authentication) exige que os usuários façam logon interativamente por meio de um navegador da Web com um token.</span><span class="sxs-lookup"><span data-stu-id="79950-141">[_Device token authentication_](#use-device-token-authentication) requires users to sign in interactively through a web browser with a token.</span></span>

<span data-ttu-id="79950-142">Todos os tipos e funções de autenticação estão disponíveis no pacote `github.com/Azure/go-autorest/autorest/azure/auth`.</span><span class="sxs-lookup"><span data-stu-id="79950-142">All authentication functions and types are available in the `github.com/Azure/go-autorest/autorest/azure/auth` package.</span></span>

> [!NOTE]
> <span data-ttu-id="79950-143">A menos que você tenha requisitos especiais, evite a autenticação baseada em cliente.</span><span class="sxs-lookup"><span data-stu-id="79950-143">Unless you have special requirements, avoid client-based authentication.</span></span> <span data-ttu-id="79950-144">Esse método de autenticação incentiva práticas incorretas.</span><span class="sxs-lookup"><span data-stu-id="79950-144">This method of authentication encourages bad practices.</span></span> <span data-ttu-id="79950-145">Em especial, o uso da autenticação baseada em cliente torna tentador o uso de credenciais embutidas em códigos.</span><span class="sxs-lookup"><span data-stu-id="79950-145">In particular, using client-based authentication makes it tempting to hard-code credentials.</span></span> <span data-ttu-id="79950-146">Escrever um código personalizado para a autenticação também pode gerar falha em versões futuras do SDK, caso os requisitos de autenticação sejam alterados.</span><span class="sxs-lookup"><span data-stu-id="79950-146">Writing custom code for authentication may also break under future SDK releases if authentication requirements change.</span></span>

## <a name="use-environment-based-authentication"></a><span data-ttu-id="79950-147">Usar a autenticação baseada em ambiente</span><span class="sxs-lookup"><span data-stu-id="79950-147">Use environment-based authentication</span></span>

<span data-ttu-id="79950-148">Se você estiver executando seu aplicativo em um ambiente controlado, a autenticação baseada em ambiente é uma opção natural.</span><span class="sxs-lookup"><span data-stu-id="79950-148">If you're running your application in a controlled setting, environment-based authentication is a natural choice.</span></span> <span data-ttu-id="79950-149">Com esse método de autenticação, você pode configurar o ambiente do shell antes de executar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="79950-149">With this authentication method, you configure the shell environment before running your application.</span></span> <span data-ttu-id="79950-150">No tempo de execução, o SDK da linguagem Go lê essas variáveis de ambiente para se autenticar no Azure.</span><span class="sxs-lookup"><span data-stu-id="79950-150">At runtime, the Go SDK reads these environment variables to authenticate with Azure.</span></span>

<span data-ttu-id="79950-151">A autenticação baseada em ambiente oferece suporte para todos os métodos de autenticação, exceto os tokens de dispositivo, avaliados na seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="79950-151">Environment-based authentication has support for all authentication methods except device tokens, evaluated in the following order:</span></span>

* <span data-ttu-id="79950-152">Credenciais do cliente</span><span class="sxs-lookup"><span data-stu-id="79950-152">Client credentials</span></span>
* <span data-ttu-id="79950-153">Certificados X509</span><span class="sxs-lookup"><span data-stu-id="79950-153">X509 certificates</span></span>
* <span data-ttu-id="79950-154">Nome de usuário/senha</span><span class="sxs-lookup"><span data-stu-id="79950-154">Username/password</span></span>
* <span data-ttu-id="79950-155">Identidades gerenciadas dos recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="79950-155">Managed identities for Azure resources</span></span>

<span data-ttu-id="79950-156">Se um tipo de autenticação não tiver valores definidos ou for recusado, o SDK tenta automaticamente o próximo tipo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="79950-156">If an authentication type has unset values or is refused, the SDK automatically tries the next authentication type.</span></span> <span data-ttu-id="79950-157">O SDK retornará um erro quando não houver mais tipos disponíveis para realizar as tentativas.</span><span class="sxs-lookup"><span data-stu-id="79950-157">When no more types are available to try, the SDK returns an error.</span></span>

<span data-ttu-id="79950-158">A tabela a seguir detalha as variáveis de ambiente que precisam ser definidas para cada tipo de autenticação com suporte da autenticação baseada em ambiente.</span><span class="sxs-lookup"><span data-stu-id="79950-158">The following table details the environment variables that need to be set for each authentication type supported by environment-based authentication.</span></span>


|  <span data-ttu-id="79950-159">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="79950-159">Authentication type</span></span>   |     <span data-ttu-id="79950-160">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="79950-160">Environment variable</span></span>     |                                                                                                     <span data-ttu-id="79950-161">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="79950-161">Description</span></span>                                                                                                      |
|------------------------|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="79950-162">**Credenciais do cliente**</span><span class="sxs-lookup"><span data-stu-id="79950-162">**Client credentials**</span></span> |      `AZURE_TENANT_ID`       |                                                                    <span data-ttu-id="79950-163">A ID do locatário do Active Directory à qual pertence a entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="79950-163">The ID for the Active Directory tenant that the service principal belongs to.</span></span>                                                                     |
|                        |      `AZURE_CLIENT_ID`       |                                                                                       <span data-ttu-id="79950-164">O nome ou a ID da entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="79950-164">The name or ID of the service principal.</span></span>                                                                                       |
|                        |    `AZURE_CLIENT_SECRET`     |                                                                                  <span data-ttu-id="79950-165">O segredo associado à entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="79950-165">The secret associated with the service principal.</span></span>                                                                                   |
|    <span data-ttu-id="79950-166">**Certificate**</span><span class="sxs-lookup"><span data-stu-id="79950-166">**Certificate**</span></span>     |      `AZURE_TENANT_ID`       |                                                                   <span data-ttu-id="79950-167">A ID do locatário do Active Directory com qual o certificado está registrado.</span><span class="sxs-lookup"><span data-stu-id="79950-167">The ID for the Active Directory tenant that the certificate is registered with.</span></span>                                                                    |
|                        |      `AZURE_CLIENT_ID`       |                                                                              <span data-ttu-id="79950-168">A ID de cliente do aplicativo associada ao certificado.</span><span class="sxs-lookup"><span data-stu-id="79950-168">The application client ID associated with the certificate.</span></span>                                                                              |
|                        |   `AZURE_CERTIFICATE_PATH`   |                                                                                       <span data-ttu-id="79950-169">O caminho para o arquivo do certificado do cliente.</span><span class="sxs-lookup"><span data-stu-id="79950-169">The path to the client certificate file.</span></span>                                                                                       |
|                        | `AZURE_CERTIFICATE_PASSWORD` |                                                                                       <span data-ttu-id="79950-170">A senha para o certificado do cliente.</span><span class="sxs-lookup"><span data-stu-id="79950-170">The password for the client certificate.</span></span>                                                                                       |
| <span data-ttu-id="79950-171">**Nome de usuário/senha**</span><span class="sxs-lookup"><span data-stu-id="79950-171">**Username/Password**</span></span>  |      `AZURE_TENANT_ID`       |                                                                           <span data-ttu-id="79950-172">A ID do locatário do Active Directory à qual o usuário pertence.</span><span class="sxs-lookup"><span data-stu-id="79950-172">The ID for the Active Directory tenant that the user belongs to.</span></span>                                                                           |
|                        |      `AZURE_CLIENT_ID`       |                                                                                              <span data-ttu-id="79950-173">A ID de cliente do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="79950-173">The application client ID.</span></span>                                                                                              |
|                        |       `AZURE_USERNAME`       |                                                                                            <span data-ttu-id="79950-174">O nome de usuário com o qual entrar.</span><span class="sxs-lookup"><span data-stu-id="79950-174">The username to sign in with.</span></span>                                                                                             |
|                        |       `AZURE_PASSWORD`       |                                                                                            <span data-ttu-id="79950-175">A senha com a qual entrar.</span><span class="sxs-lookup"><span data-stu-id="79950-175">The password to sign in with.</span></span>                                                                                             |
|  <span data-ttu-id="79950-176">**Identidade gerenciada**</span><span class="sxs-lookup"><span data-stu-id="79950-176">**Managed identity**</span></span>  |                              | <span data-ttu-id="79950-177">Nenhuma credencial é necessária para a autenticação da identidade gerenciada.</span><span class="sxs-lookup"><span data-stu-id="79950-177">No credentials are needed for managed identity authentication.</span></span> <span data-ttu-id="79950-178">O aplicativo deve estar em execução em um recurso do Azure configurado para usar as identidades gerenciadas.</span><span class="sxs-lookup"><span data-stu-id="79950-178">The application must be running on an Azure resource configured to use managed identities.</span></span> <span data-ttu-id="79950-179">Para obter mais detalhes, confira [Identidades gerenciadas para os recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="79950-179">For details, see [Managed identities for Azure resources].</span></span> |

<span data-ttu-id="79950-180">Para se conectar a um ponto de extremidade de gerenciamento ou de nuvem que não seja o padrão de nuvem pública do Azure, defina as seguintes variáveis de ambiente.</span><span class="sxs-lookup"><span data-stu-id="79950-180">To connect to a cloud or management endpoint other than the default Azure public cloud, set the following environment variables.</span></span> <span data-ttu-id="79950-181">Se você usa o Azure Stack, os motivos mais comuns são: uma nuvem em uma região geográfica diferente ou o modelo de implantação clássico.</span><span class="sxs-lookup"><span data-stu-id="79950-181">The most common reasons are if you use Azure Stack, a cloud in a different geographic region, or the classic deployment model.</span></span>

| <span data-ttu-id="79950-182">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="79950-182">Environment variable</span></span> | <span data-ttu-id="79950-183">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="79950-183">Description</span></span>  |
|----------------------|--------------|
| `AZURE_ENVIRONMENT` | <span data-ttu-id="79950-184">O nome do ambiente de nuvem ao qual se conectar.</span><span class="sxs-lookup"><span data-stu-id="79950-184">The name of the cloud environment to connect to.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="79950-185">A ID de recurso do Active Directory para usar ao conectar-se, como um URI para seu ponto de extremidade de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="79950-185">The Active Directory resource ID to use when connecting, as a URI to your management endpoint.</span></span> |

<span data-ttu-id="79950-186">Ao usar a autenticação baseada em ambiente, chame a função [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) para obter o objeto autorizador.</span><span class="sxs-lookup"><span data-stu-id="79950-186">When using environment-based authentication, call the [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) function to get your authorizer object.</span></span> <span data-ttu-id="79950-187">Esse objeto é então ativado na propriedade `Authorizer` de clientes para permitir o acesso ao Azure.</span><span class="sxs-lookup"><span data-stu-id="79950-187">This object is then set on the `Authorizer` property of clients to allow them access to Azure.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := auth.NewAuthorizerFromEnvironment()
```

### <a name="authentication-on-azure-stack"></a><span data-ttu-id="79950-188">Autenticação no Azure Stack</span><span class="sxs-lookup"><span data-stu-id="79950-188">Authentication on Azure Stack</span></span>

<span data-ttu-id="79950-189">Para autenticar no Azure Stack, você precisa definir as seguintes variáveis:</span><span class="sxs-lookup"><span data-stu-id="79950-189">To authenticate on Azure Stack, you need to set the following variables:</span></span>

| <span data-ttu-id="79950-190">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="79950-190">Environment variable</span></span> | <span data-ttu-id="79950-191">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="79950-191">Description</span></span>  |
|----------------------|--------------|
| `AZURE_AD_ENDPOINT` | <span data-ttu-id="79950-192">O ponto de extremidade do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="79950-192">The Active Directory endpoint.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="79950-193">A ID de recurso do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="79950-193">The Active Directory resource ID.</span></span> |

<span data-ttu-id="79950-194">Essas variáveis podem ser recuperadas de informações de metadados do Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="79950-194">These variables can be retrieved from Azure Stack metadata information.</span></span> <span data-ttu-id="79950-195">Para recuperar os metadados, abra um navegador da Web em seu ambiente do Azure Stack e use a URL: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span><span class="sxs-lookup"><span data-stu-id="79950-195">To retrieve the metadata, open a web browser in your Azure Stack environment and use the url: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span></span>

<span data-ttu-id="79950-196">O `ResourceManagerURL` varia de acordo com o nome da região, nome do computador e nome externo de domínio totalmente qualificado (FQDN) da sua implantação do Azure Stack:</span><span class="sxs-lookup"><span data-stu-id="79950-196">The `ResourceManagerURL` varies based on the region name, machine name, and external fully qualified domain name (FQDN) of your Azure Stack deployment:</span></span>

| <span data-ttu-id="79950-197">Ambiente</span><span class="sxs-lookup"><span data-stu-id="79950-197">Environment</span></span> | <span data-ttu-id="79950-198">ResourceManagerURL</span><span class="sxs-lookup"><span data-stu-id="79950-198">ResourceManagerURL</span></span> |
|----------------------|--------------|
| <span data-ttu-id="79950-199">Kit de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="79950-199">Development Kit</span></span> | `https://management.local.azurestack.external/` |
| <span data-ttu-id="79950-200">Sistemas Integrados</span><span class="sxs-lookup"><span data-stu-id="79950-200">Integrated Systems</span></span> | `https://management.(region).ext-(machine-name).(FQDN)` |

<span data-ttu-id="79950-201">Para ter mais informações sobre como usar o SDK do Azure para linguagem Go no Azure Stack, confira [Usar perfis de versão de API com a linguagem Go no Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go)</span><span class="sxs-lookup"><span data-stu-id="79950-201">For more information on how to use the Azure SDK for Go on Azure Stack, see [Use API version profiles with Go in Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go)</span></span>

## <a name="use-file-based-authentication"></a><span data-ttu-id="79950-202">Usar a autenticação baseada em arquivo</span><span class="sxs-lookup"><span data-stu-id="79950-202">Use file-based authentication</span></span>

<span data-ttu-id="79950-203">A autenticação baseada em arquivo usa um formato de arquivo gerado pela [CLI do Azure](/cli/azure).</span><span class="sxs-lookup"><span data-stu-id="79950-203">File-based authentication uses a file format generated by [the Azure CLI](/cli/azure).</span></span> <span data-ttu-id="79950-204">É possível criar esse arquivo facilmente ao criar uma nova entidade de serviço com o parâmetro `--sdk-auth`.</span><span class="sxs-lookup"><span data-stu-id="79950-204">You can easily create this file when creating a new service principal with the `--sdk-auth` parameter.</span></span> <span data-ttu-id="79950-205">Caso planeje usar a autenticação baseada em arquivo, verifique se esse argumento é fornecido durante a criação de uma entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="79950-205">If you plan on using file-based authentication, make sure that this argument is provided when creating a service principal.</span></span> <span data-ttu-id="79950-206">Uma vez que a CLI imprime a saída para `stdout`, redirecione a saída para um arquivo.</span><span class="sxs-lookup"><span data-stu-id="79950-206">Since the CLI prints output to `stdout`, redirect output to a file.</span></span>

```azurecli
az ad sp create-for-rbac --sdk-auth > azure.auth
```

<span data-ttu-id="79950-207">Defina a variável de ambiente `AZURE_AUTH_LOCATION` para o local em que se encontra o arquivo de autorização.</span><span class="sxs-lookup"><span data-stu-id="79950-207">Set the `AZURE_AUTH_LOCATION` environment variable to where the authorization file is located.</span></span> <span data-ttu-id="79950-208">Essa variável de ambiente é lida pelo aplicativo, e as credenciais dentro dela são analisadas.</span><span class="sxs-lookup"><span data-stu-id="79950-208">This environment variable is read by the application, and the credentials within it are parsed.</span></span> <span data-ttu-id="79950-209">Caso precise selecionar o arquivo de autorização em tempo de execução, manipule o ambiente do programa usando a função [os.Setenv](https://golang.org/pkg/os/#Setenv).</span><span class="sxs-lookup"><span data-stu-id="79950-209">If you need to select the authorization file at runtime, manipulate the program's environment using the [os.Setenv](https://golang.org/pkg/os/#Setenv) function.</span></span>

<span data-ttu-id="79950-210">Para carregar as informações de autenticação, chame a função [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile).</span><span class="sxs-lookup"><span data-stu-id="79950-210">To load the authentication information, call the [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile) function.</span></span> <span data-ttu-id="79950-211">Ao contrário da autorização baseada em ambiente, a autorização baseada em arquivo exige um ponto de extremidade do recurso.</span><span class="sxs-lookup"><span data-stu-id="79950-211">Unlike environment-based authorization, file-based authorization requires a resource endpoint.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := NewAuthorizerFromFile(azure.PublicCloud.ResourceManagerEndpoint)
```

<span data-ttu-id="79950-212">Para obter mais informações sobre como usar as entidades de serviço e como gerenciar suas permissões de acesso, confira [Criar uma entidade de serviço com a CLI do Azure].</span><span class="sxs-lookup"><span data-stu-id="79950-212">For more on using service principals and managing their access permissions, see [Create a service principal with Azure CLI].</span></span>

## <a name="use-device-token-authentication"></a><span data-ttu-id="79950-213">Usar autenticação de token do dispositivo</span><span class="sxs-lookup"><span data-stu-id="79950-213">Use device token authentication</span></span>

<span data-ttu-id="79950-214">Caso queira que os usuários entrem interativamente, a autenticação de token do dispositivo é a melhor forma.</span><span class="sxs-lookup"><span data-stu-id="79950-214">If you want users to sign in interactively, the best way is through device token authentication.</span></span> <span data-ttu-id="79950-215">Esse fluxo de autenticação passa ao usuário um token para ser colado em um site de entrada da Microsoft, onde eles, então, autenticam com uma conta do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="79950-215">This authentication flow passes the user a token to paste into a Microsoft sign-in site, where they then authenticate with an Azure Active Directory (AAD) account.</span></span> <span data-ttu-id="79950-216">Esse método de autenticação oferece suporte a contas que têm a autenticação multifator habilitada, ao contrário de autenticação padrão de nome de usuário/senha.</span><span class="sxs-lookup"><span data-stu-id="79950-216">This authentication method supports accounts that have multi-factor authentication enabled, unlike standard username/password authentication.</span></span>

<span data-ttu-id="79950-217">Para usar uma autenticação de token do dispositivo, crie um autorizador [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) com a função [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig).</span><span class="sxs-lookup"><span data-stu-id="79950-217">To use device token authentication, create a [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) authorizer with the [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig) function.</span></span> <span data-ttu-id="79950-218">Chame o [Autorizador](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) no objeto resultante para iniciar o processo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="79950-218">Call [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) on the resulting object to start the authentication process.</span></span> <span data-ttu-id="79950-219">A autenticação de fluxo do dispositivo bloqueia a execução do programa até que todo o fluxo de autenticação seja concluído.</span><span class="sxs-lookup"><span data-stu-id="79950-219">Device flow authentication blocks program execution until the whole authentication flow is complete.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
deviceConfig := auth.NewDeviceFlowConfig(applicationID, tenantID)
authorizer, err := deviceConfig.Authorizer()
```

## <a name="use-an-authentication-client"></a><span data-ttu-id="79950-220">Usar um cliente de autenticação</span><span class="sxs-lookup"><span data-stu-id="79950-220">Use an authentication client</span></span>

<span data-ttu-id="79950-221">Caso precise de um tipo específico de autenticação e esteja disposto que seu programa faça o trabalho de carregar informações de autenticação do usuário, você pode usar qualquer cliente que esteja de acordo com a interface [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig).</span><span class="sxs-lookup"><span data-stu-id="79950-221">If you require a specific type of authentication and are willing to have your program do the work to load authentication information from the user, you can use any client that conforms to the [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig) interface.</span></span> <span data-ttu-id="79950-222">Use um tipo que implementará essa interface quando você:</span><span class="sxs-lookup"><span data-stu-id="79950-222">Use a type that implements this interface when you:</span></span>

* <span data-ttu-id="79950-223">Escrever um programa interativo</span><span class="sxs-lookup"><span data-stu-id="79950-223">Write an interactive program</span></span>
* <span data-ttu-id="79950-224">Usar arquivos de configuração especializados</span><span class="sxs-lookup"><span data-stu-id="79950-224">Use specialized configuration files</span></span>
* <span data-ttu-id="79950-225">Tiver um requisito que impeça o uso de um método de autenticação interno</span><span class="sxs-lookup"><span data-stu-id="79950-225">Have a requirement that prevents using a built-in authentication method</span></span>

> [!WARNING]
> <span data-ttu-id="79950-226">Nunca use credenciais do Azure embutidas em código em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="79950-226">Never hard-code Azure credentials into an application.</span></span> <span data-ttu-id="79950-227">Colocar segredos em um binário de aplicativo facilita sua extração por um invasor, quer o aplicativo esteja em execução ou não.</span><span class="sxs-lookup"><span data-stu-id="79950-227">Putting secrets into an application binary makes it easier for an attacker to extract them, whether the application is running or not.</span></span> <span data-ttu-id="79950-228">Isso coloca em risco todos os recursos do Azure para os quais as credenciais são autorizadas!</span><span class="sxs-lookup"><span data-stu-id="79950-228">This puts all Azure resources the credentials are authorized for at risk!</span></span>

<span data-ttu-id="79950-229">A tabela a seguir lista os tipos no SDK que estão de acordo com a interface `AuthorizerConfig`.</span><span class="sxs-lookup"><span data-stu-id="79950-229">The following table lists the types in the SDK that conform to the `AuthorizerConfig` interface.</span></span>

| <span data-ttu-id="79950-230">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="79950-230">Authentication type</span></span> | <span data-ttu-id="79950-231">Tipo de autorizador</span><span class="sxs-lookup"><span data-stu-id="79950-231">Authorizer type</span></span> |
|---------------------|-----------------------|
| <span data-ttu-id="79950-232">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="79950-232">Certificate-based authentication</span></span> | <span data-ttu-id="79950-233">[ClientCertificateConfig]</span><span class="sxs-lookup"><span data-stu-id="79950-233">[ClientCertificateConfig]</span></span> |
| <span data-ttu-id="79950-234">Credenciais do cliente</span><span class="sxs-lookup"><span data-stu-id="79950-234">Client credentials</span></span> | <span data-ttu-id="79950-235">[ClientCredentialsConfig]</span><span class="sxs-lookup"><span data-stu-id="79950-235">[ClientCredentialsConfig]</span></span> |
| <span data-ttu-id="79950-236">Identidades gerenciadas dos recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="79950-236">Managed identities for Azure resources</span></span> | <span data-ttu-id="79950-237">[MSIConfig]</span><span class="sxs-lookup"><span data-stu-id="79950-237">[MSIConfig]</span></span> |
| <span data-ttu-id="79950-238">Nome de usuário/senha</span><span class="sxs-lookup"><span data-stu-id="79950-238">Username/password</span></span> | <span data-ttu-id="79950-239">[UsernamePasswordConfig]</span><span class="sxs-lookup"><span data-stu-id="79950-239">[UsernamePasswordConfig]</span></span> |

[ClientCertificateConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCertificateConfig
[ClientCredentialsConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCredentialsConfig
[MSIConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#MSIConfig
[DeviceFlowConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig
[UsernamePasswordConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#UsernamePasswordConfig

<span data-ttu-id="79950-244">Crie um autenticador com sua função `New` associada e, em seguida, chame `Authorize` no objeto resultante para autenticar.</span><span class="sxs-lookup"><span data-stu-id="79950-244">Create an authenticator with its associated `New` function, and then call `Authorize` on the resulting object to authenticate.</span></span> <span data-ttu-id="79950-245">Por exemplo, para usar a autenticação baseada em certificado:</span><span class="sxs-lookup"><span data-stu-id="79950-245">For example, to use certificate-based authentication:</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
certificateAuthorizer := auth.NewClientCertificateConfig(certificatePath, certificatePassword, clientID, tenantID)
authorizerToken, err := certificateAuthorizer.Authorize()
```
