---
title: Autenticação com o SDK do Azure para Go
description: Saiba mais sobre os métodos de autenticação disponíveis no SDK do Azure para Go e como usá-los.
services: azure
author: sptramer
ms.author: sttramer
manager: carmonm
ms.date: 04/03/2018
ms.topic: conceptual
ms.prod: azure
ms.technology: azure-sdk-go
ms.devlang: go
ms.service: active-directory
ms.component: authentication
ms.openlocfilehash: 370f5607b89c0044022f7987d06c3a55c9d6f352
ms.sourcegitcommit: f08abf902b48f8173aa6e261084ff2cfc9043305
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/03/2018
ms.locfileid: "32319876"
---
# <a name="authentication-methods-in-the-azure-sdk-for-go"></a><span data-ttu-id="7c4b0-103">Métodos de autenticação no SDK do Azure para Go</span><span class="sxs-lookup"><span data-stu-id="7c4b0-103">Authentication methods in the Azure SDK for Go</span></span>

<span data-ttu-id="7c4b0-104">O SDK do Azure para Go oferece uma variedade de tipos de autenticação e métodos que podem ser usados pelo seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-104">The Azure SDK for Go offers a variety of authentication types and methods that your application can use.</span></span> <span data-ttu-id="7c4b0-105">Os métodos de autenticação com suporte variam do pull de informações de variáveis de ambiente até a autenticação interativa baseada na Web.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-105">Supported authentication methods range from pulling information from environment variables to interactive web-based authentication.</span></span> <span data-ttu-id="7c4b0-106">Este artigo apresenta os tipos de autenticação disponíveis no SDK, além dos métodos para usá-los.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-106">This article introduces you to the available types of authentication in the SDK, and the methods for using them.</span></span> <span data-ttu-id="7c4b0-107">Você também aprenderá as melhores práticas para selecionar o tipo de autenticação adequado para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-107">You'll also learn best practices for selecting which authentication type is right for your application.</span></span>

## <a name="available-authentication-types-and-methods"></a><span data-ttu-id="7c4b0-108">Métodos e tipos de autenticação disponíveis</span><span class="sxs-lookup"><span data-stu-id="7c4b0-108">Available authentication types and methods</span></span>

<span data-ttu-id="7c4b0-109">O SDK do Azure para Go oferece vários tipos diferentes de autenticação, usando conjuntos de credenciais diferentes.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-109">The Azure SDK for Go offers several different types of authentication, using different credentials sets.</span></span> <span data-ttu-id="7c4b0-110">Cada um desses tipos de autenticação está disponível por métodos de autenticação diferentes, que são como o SDK usa essas credenciais como entrada.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-110">Each of these authentication types are available through different authentication methods, which are how the SDK takes these credentials as input.</span></span> <span data-ttu-id="7c4b0-111">A tabela a seguir descreve os tipos disponíveis de autenticação e as situações em que eles são recomendados para uso pelo seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-111">The following table describes the available types of authentication and situations in which they're recommended for use by your application.</span></span>

| <span data-ttu-id="7c4b0-112">Tipo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-112">Authentication type</span></span> | <span data-ttu-id="7c4b0-113">Recomendado quando...</span><span class="sxs-lookup"><span data-stu-id="7c4b0-113">Recommended when...</span></span> |
|---------------------|---------------------|
| <span data-ttu-id="7c4b0-114">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="7c4b0-114">Certificate-based authentication</span></span> | <span data-ttu-id="7c4b0-115">Você tem um certificado X509 que foi configurado para um usuário do Azure Active Directory (AAD) ou uma entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-115">You have an X509 certificate that was configured for an Azure Active Directory (AAD) user or service principal.</span></span> <span data-ttu-id="7c4b0-116">Para saber mais, consulte [Introdução à autenticação baseada em certificado no Azure Active Directory].</span><span class="sxs-lookup"><span data-stu-id="7c4b0-116">To learn more, see [Get started with certificate-based authentication in Azure Active Directory].</span></span> |
| <span data-ttu-id="7c4b0-117">Credenciais do cliente</span><span class="sxs-lookup"><span data-stu-id="7c4b0-117">Client credentials</span></span> | <span data-ttu-id="7c4b0-118">Você tem uma entidade de serviço configurada que está definida para esse aplicativo ou para uma classe de aplicativos à qual ele pertence.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-118">You have a configured service principal that is set up for this application or a class of applications it belongs to.</span></span> <span data-ttu-id="7c4b0-119">Para saber mais, consulte [Criar uma entidade de serviço com a CLI do Azure 2.0].</span><span class="sxs-lookup"><span data-stu-id="7c4b0-119">To learn more, see [Create a service principal with Azure CLI 2.0].</span></span> |
| <span data-ttu-id="7c4b0-120">MSI (Identidade do serviço gerenciado)</span><span class="sxs-lookup"><span data-stu-id="7c4b0-120">Managed Service Identity (MSI)</span></span> | <span data-ttu-id="7c4b0-121">O aplicativo está em execução em um recurso do Azure que foi configurado com a MSI.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-121">Your application is running on an Azure resource that has been configured with Managed Service Identity (MSI).</span></span> <span data-ttu-id="7c4b0-122">Para saber mais, consulte [MSI (Identidade do serviço gerenciado) para recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="7c4b0-122">To learn more, see [Managed Service Identity (MSI) for Azure resources].</span></span> |
| <span data-ttu-id="7c4b0-123">Token de dispositivo</span><span class="sxs-lookup"><span data-stu-id="7c4b0-123">Device token</span></span> | <span data-ttu-id="7c4b0-124">Seu aplicativo foi projetado para ser usado __apenas__ interativamente, além disso, ele terá uma variedade de usuários, potencialmente de vários locatários do AAD.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-124">Your application is meant to be used interactively __only__ and will have a variety of users, potentially from multiple AAD tenants.</span></span> <span data-ttu-id="7c4b0-125">Os usuários têm acesso a um navegador da Web para fazer logon.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-125">Users have access to a web browser to log in.</span></span> <span data-ttu-id="7c4b0-126">Para obter mais informações, consulte [Usar a autenticação de token do dispositivo](#use-device-token-authentication).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-126">For more information, see [Use device token authentication](#use-device-token-authentication).</span></span>|
| <span data-ttu-id="7c4b0-127">Nome de usuário/senha</span><span class="sxs-lookup"><span data-stu-id="7c4b0-127">Username/password</span></span> | <span data-ttu-id="7c4b0-128">Você tem um aplicativo interativo que não pode usar nenhum outro método de autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-128">You have an interactive application that cannot use any other authentication method.</span></span> <span data-ttu-id="7c4b0-129">Os usuários não têm a autenticação multifator habilitada para seu logon no AAD.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-129">Your users do not have multi-factor authentication enabled for their AAD login.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="7c4b0-130">Se você usar um tipo de autenticação que não sejam as credenciais do cliente, seu aplicativo deve estar registrado no Active Directory do Azure.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-130">If you use an authentication type other than client credentials, your application must be registered in Azure Active Directory.</span></span> <span data-ttu-id="7c4b0-131">Para saber mais, [Integrando aplicativos com o Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-131">To learn how, see [Integrating applications with Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span></span>

> [!NOTE]
> <span data-ttu-id="7c4b0-132">A menos que você tenha requisitos especiais, evite a autenticação de nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-132">Unless you have special requirements, avoid username/password authentication.</span></span> <span data-ttu-id="7c4b0-133">Em situações em que o logon baseado em usuário for apropriado, pode ser usada a autenticação de token do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-133">In situations where user-based login is appropriate, device token authentication can usually be used instead.</span></span>

[Introdução à autenticação baseada em certificado no Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Get started with certificate-based authentication in Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Criar uma entidade de serviço com a CLI do Azure 2.0]: /cli/azure/create-an-azure-service-principal-azure-cli
[Create a service principal with Azure CLI 2.0]: /cli/azure/create-an-azure-service-principal-azure-cli
[MSI (Identidade do serviço gerenciado) para recursos do Azure]: /azure/active-directory/managed-service-identity/overview
[Managed Service Identity (MSI) for Azure resources]: /azure/active-directory/managed-service-identity/overview

<span data-ttu-id="7c4b0-137">Esses tipos de autenticação estão disponíveis por meio de métodos diferentes.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-137">These authentication types are available through different methods.</span></span> <span data-ttu-id="7c4b0-138">A [_Autenticação baseada em ambiente_](#use-environment-based-authentication) lê credenciais diretamente do ambiente do programa.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-138">[_Environment-based authentication_](#use-environment-based-authentication) reads credentials directly from the program's environment.</span></span> <span data-ttu-id="7c4b0-139">A [_Autenticação baseada em arquivo_](#use-file-based-authentication) carrega um arquivo contendo as credenciais de entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-139">[_File-based authentication_](#use-file-based-authentication) loads a file containing service principal credentials.</span></span> <span data-ttu-id="7c4b0-140">A [_Autenticação baseada em cliente_](#use-an-authentication-client) usa um objeto em código Go e torna você responsável por fornecer as credenciais durante a execução do programa.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-140">[_Client-based authentication_](#use-an-authentication-client) uses an object in Go code and makes you responsible for providing the credentials during program execution.</span></span> <span data-ttu-id="7c4b0-141">Por fim, a [_autenticação de token do dispositivo_](#use-device-token-authentication) requer que os usuários façam logon interativamente por meio de um navegador da Web com um token, não podendo ser usada com autenticações baseadas em ambiente ou arquivo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-141">Finally, [_Device token authentication_](#use-device-token-authentication) requires users to log in interactively through a web browser with a token, and cannot be used with environment- or file-based authentication.</span></span>

<span data-ttu-id="7c4b0-142">Todos os tipos e funções de autenticação estão disponíveis no pacote `github.com/Azure/go-autorest/autorest/azure/auth`.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-142">All authentication functions and types are available in the `github.com/Azure/go-autorest/autorest/azure/auth` package.</span></span>

> [!NOTE]
> <span data-ttu-id="7c4b0-143">A menos que você tenha requisitos especiais, evite a autenticação baseada em cliente.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-143">Unless you have special requirements, avoid client-based authentication.</span></span> <span data-ttu-id="7c4b0-144">Esse método de autenticação incentiva práticas incorretas.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-144">This method of authentication encourages bad practices.</span></span> <span data-ttu-id="7c4b0-145">Em especial, o uso da autenticação baseada em cliente torna tentador o uso de credenciais embutidas em códigos.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-145">In particular, using client-based authentication makes it tempting to hard-code credentials.</span></span> <span data-ttu-id="7c4b0-146">Escrever um código personalizado para a autenticação também pode gerar falha em versões futuras do SDK, caso os requisitos de autenticação sejam alterados.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-146">Writing custom code for authentication may also break under future SDK releases if authentication requirements change.</span></span>

## <a name="use-environment-based-authentication"></a><span data-ttu-id="7c4b0-147">Usar a autenticação baseada em ambiente</span><span class="sxs-lookup"><span data-stu-id="7c4b0-147">Use environment-based authentication</span></span>

<span data-ttu-id="7c4b0-148">Se você estiver executando seu aplicativo em um ambiente rigidamente controlado, como um contêiner, a autenticação baseada em ambiente é uma opção natural.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-148">If you're running your application in a tightly controlled environment such as in a container, environment-based authentication is a natural choice.</span></span> <span data-ttu-id="7c4b0-149">Você configura o ambiente de shell antes de executar seu aplicativo, e o SDK do Go lê essas variáveis de ambiente em tempo de execução para autenticar com o Azure.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-149">You configure the shell environment before running your application and the Go SDK reads these environment variables at runtime to authenticate with Azure.</span></span> 

<span data-ttu-id="7c4b0-150">A autenticação baseada em ambiente oferece suporte para todos os métodos de autenticação, exceto os tokens de dispositivo, avaliados na seguinte ordem: credenciais de cliente, certificados, nome de usuário/senha e identidade de serviço gerenciado (MSI).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-150">Environment-based authentication has support for all authentication methods except device tokens, evaluated in the following order: Client credentials, certificates, username/password, and Managed Service Identity (MSI).</span></span> <span data-ttu-id="7c4b0-151">Se uma variável de ambiente necessária for removida ou se o SDK obtiver uma recusa do serviço de autenticação, tenta-se usar o próximo tipo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-151">If a required environment variable is unset or the SDK gets a refusal from the authentication service, the next authentication type is tried.</span></span> <span data-ttu-id="7c4b0-152">Se o SDK não puder ser autenticado a partir do ambiente, ele retornará um erro.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-152">If the SDK cannot authenticate from the environment, it returns an error.</span></span>

<span data-ttu-id="7c4b0-153">A tabela a seguir detalha as variáveis de ambiente que precisam ser definidas para cada tipo de autenticação com suporte da autenticação baseada em ambiente.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-153">The following table details the environment variables that need to be set for each authentication type supported by environment-based authentication.</span></span>

| <span data-ttu-id="7c4b0-154">Tipo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-154">Authentication type</span></span> | <span data-ttu-id="7c4b0-155">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="7c4b0-155">Environment variable</span></span> | <span data-ttu-id="7c4b0-156">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="7c4b0-156">Description</span></span> |
| ------------------- | -------------------- | ----------- |
| <span data-ttu-id="7c4b0-157">__Credenciais do cliente__</span><span class="sxs-lookup"><span data-stu-id="7c4b0-157">__Client credentials__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="7c4b0-158">A ID do locatário do Active Directory à qual pertence a entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-158">The ID for the Active Directory tenant that the service principal belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="7c4b0-159">O nome ou a ID da entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-159">The name or ID of the service principal.</span></span> |
| | `AZURE_CLIENT_SECRET` | <span data-ttu-id="7c4b0-160">O segredo associado à entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-160">The secret associated with the service principal.</span></span> |
| <span data-ttu-id="7c4b0-161">__Certificate__</span><span class="sxs-lookup"><span data-stu-id="7c4b0-161">__Certificate__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="7c4b0-162">A ID do locatário do Active Directory com qual o certificado está registrado.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-162">The ID for the Active Directory tenant that the certificate is registered with.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="7c4b0-163">A ID de cliente do aplicativo associada ao certificado.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-163">The application client ID associated with the certificate.</span></span> |
| | `AZURE_CERTIFICATE_PATH` | <span data-ttu-id="7c4b0-164">O caminho para o arquivo do certificado do cliente.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-164">The path to the client certificate file.</span></span> |
| | `AZURE_CERTIFICATE_PASSWORD` | <span data-ttu-id="7c4b0-165">A senha para o certificado do cliente.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-165">The password for the client certificate.</span></span> |
| <span data-ttu-id="7c4b0-166">__Nome de usuário/senha__</span><span class="sxs-lookup"><span data-stu-id="7c4b0-166">__Username/Password__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="7c4b0-167">A ID do locatário do Active Directory à qual o usuário pertence.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-167">The ID for the Active Directory tenant that the user belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="7c4b0-168">A ID de cliente do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-168">The application client ID.</span></span> |
| | `AZURE_USERNAME` | <span data-ttu-id="7c4b0-169">O nome de usuário para fazer logon.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-169">The username to log in with.</span></span> |
| | `AZURE_PASSWORD` | <span data-ttu-id="7c4b0-170">A senha para fazer logon.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-170">The password to log in with.</span></span> |
| <span data-ttu-id="7c4b0-171">__MSI__</span><span class="sxs-lookup"><span data-stu-id="7c4b0-171">__MSI__</span></span> | | <span data-ttu-id="7c4b0-172">A MSI não requer que nenhuma credencial seja definida.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-172">MSI does not require any credentials to be set.</span></span> <span data-ttu-id="7c4b0-173">O aplicativo deve estar em execução em um recurso do Azure configurado para usar a MSI.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-173">The application must be running on an Azure resource configured to use MSI.</span></span> <span data-ttu-id="7c4b0-174">Para obter detalhes, consulte [MSI (Identidade do serviço gerenciado) para recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="7c4b0-174">For details, see [Managed Service Identity (MSI) for Azure resources].</span></span> |

<span data-ttu-id="7c4b0-175">Caso precise se conectar a um ponto de extremidade de nuvem ou de gerenciamento que não seja o padrão de nuvem pública do Azure, também é possível definir as seguintes variáveis de ambiente.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-175">If you need to connect to a cloud or management endpoint other than the default Azure public cloud, you can also set the following environment variables.</span></span> <span data-ttu-id="7c4b0-176">Os motivos mais comuns para defini-las são: se você usa o Azure Stack, uma nuvem em uma região geográfica diferente ou o modelo de implantação clássico do Azure.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-176">The most common reasons to set them are if you use Azure Stack, a cloud in a different geographic region, or the Azure Classic deployment model.</span></span>

| <span data-ttu-id="7c4b0-177">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="7c4b0-177">Environment variable</span></span> | <span data-ttu-id="7c4b0-178">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="7c4b0-178">Description</span></span>  |
|----------------------|--------------|
| `AZURE_ENVIRONMENT` | <span data-ttu-id="7c4b0-179">O nome do ambiente de nuvem ao qual se conectar.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-179">The name of the cloud environment to connect to.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="7c4b0-180">A ID de recurso do Active Directory para usar ao se conectar.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-180">The Active Directory resource ID to use when connecting.</span></span> <span data-ttu-id="7c4b0-181">Deve ser um URI apontando para seu ponto de extremidade de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-181">This should be a URI pointing to your management endpoint.</span></span> |

<span data-ttu-id="7c4b0-182">Ao usar a autenticação baseada em ambiente, chame a função [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) para obter o objeto autorizador.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-182">When using environment-based authentication, call the [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) function to get your authorizer object.</span></span> <span data-ttu-id="7c4b0-183">Esse objeto é então ativado na propriedade `Authorizer` de clientes para permitir o acesso ao Azure.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-183">This object is then set on the `Authorizer` property of clients to allow them access to Azure.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := auth.NewAuthorizerFromEnvironment()
```

### <a name="authentication-on-azure-stack"></a><span data-ttu-id="7c4b0-184">Autenticação no Azure Stack</span><span class="sxs-lookup"><span data-stu-id="7c4b0-184">Authentication on Azure Stack</span></span>

<span data-ttu-id="7c4b0-185">Para autenticar no Azure Stack, você precisa definir as seguintes variáveis:</span><span class="sxs-lookup"><span data-stu-id="7c4b0-185">To authenticate on Azure Stack, you need to set the following variables:</span></span>

| <span data-ttu-id="7c4b0-186">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="7c4b0-186">Environment variable</span></span> | <span data-ttu-id="7c4b0-187">DESCRIÇÃO</span><span class="sxs-lookup"><span data-stu-id="7c4b0-187">Description</span></span>  |
|----------------------|--------------|
| `AZURE_AD_ENDPOINT` | <span data-ttu-id="7c4b0-188">O ponto de extremidade do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-188">The Active Directory endpoint.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="7c4b0-189">A ID de recurso do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-189">The Active Directory resource ID.</span></span> |

<span data-ttu-id="7c4b0-190">Essas variáveis podem ser recuperadas de informações de metadados do Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-190">These variables can be retrieved from Azure Stack metadata information.</span></span> <span data-ttu-id="7c4b0-191">Para recuperar os metadados, abra um navegador da Web em seu ambiente do Azure Stack e use a URL: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span><span class="sxs-lookup"><span data-stu-id="7c4b0-191">To retrieve the metadata, open a web browser in your Azure Stack environment and use the url: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span></span>

<span data-ttu-id="7c4b0-192">O `ResourceManagerURL` varia de acordo com o nome da região, nome do computador e nome externo de domínio totalmente qualificado (FQDN) da sua implantação do Azure Stack:</span><span class="sxs-lookup"><span data-stu-id="7c4b0-192">The `ResourceManagerURL` varies based on the region name, machine name and external fully qualified domain name (FQDN) of your Azure Stack deployment:</span></span>

| <span data-ttu-id="7c4b0-193">Ambiente</span><span class="sxs-lookup"><span data-stu-id="7c4b0-193">Environment</span></span> | <span data-ttu-id="7c4b0-194">ResourceManagerURL</span><span class="sxs-lookup"><span data-stu-id="7c4b0-194">ResourceManagerURL</span></span> |
|----------------------|--------------|
| <span data-ttu-id="7c4b0-195">Kit de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="7c4b0-195">Development Kit</span></span> | `https://management.local.azurestack.external/` |
| <span data-ttu-id="7c4b0-196">Sistemas Integrados</span><span class="sxs-lookup"><span data-stu-id="7c4b0-196">Integrated Systems</span></span> | `https://management.(region).ext-(machine-name).(FQDN)` |

<span data-ttu-id="7c4b0-197">Para obter mais detalhes sobre como usar o SDK do Azure para Go no Azure Stack, confira [Usar perfis de versão de API com o Go no Azure Stack](https://docs.microsoft.com/en-us/azure/azure-stack/user/azure-stack-version-profiles-go)</span><span class="sxs-lookup"><span data-stu-id="7c4b0-197">For more details on how to use Azure SDK for Go on Azure Stack see [Use API version profiles with Go in Azure Stack](https://docs.microsoft.com/en-us/azure/azure-stack/user/azure-stack-version-profiles-go)</span></span>


## <a name="use-file-based-authentication"></a><span data-ttu-id="7c4b0-198">Usar a autenticação baseada em arquivo</span><span class="sxs-lookup"><span data-stu-id="7c4b0-198">Use file-based authentication</span></span>

<span data-ttu-id="7c4b0-199">A autenticação baseada em arquivo só funciona com as credenciais do cliente quando elas estão armazenadas em um formato de arquivo local gerado pela [CLI do Azure 2.0](/cli/azure).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-199">File-based authentication only works with client credentials when they are stored in a local file format generated by [the Azure CLI 2.0](/cli/azure).</span></span> <span data-ttu-id="7c4b0-200">É possível criar esse arquivo facilmente ao criar uma nova entidade de serviço com o parâmetro `--sdk-auth`.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-200">You can easily create this file when creating a new service principal with the `--sdk-auth` parameter.</span></span> <span data-ttu-id="7c4b0-201">Caso planeje usar a autenticação baseada em arquivo, verifique se esse argumento é fornecido durante a criação de uma entidade de serviço.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-201">If you plan on using file-based authentication, make sure that this argument is provided when creating a service principal.</span></span> <span data-ttu-id="7c4b0-202">Uma vez que a CLI imprime a saída para `stdout`, redirecione a saída para um arquivo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-202">Since the CLI prints output to `stdout`, redirect output to a file.</span></span>

```azurecli
az ad sp create-for-rbac --sdk-auth > azure.auth
```

<span data-ttu-id="7c4b0-203">Defina a variável de ambiente `AZURE_AUTH_LOCATION` para o local em que se encontra o arquivo de autorização.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-203">Set the `AZURE_AUTH_LOCATION` environment variable to where the authorization file is located.</span></span> <span data-ttu-id="7c4b0-204">Essa variável de ambiente é lida pelo aplicativo, e as credenciais dentro dela são analisadas.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-204">This environment variable is read by the application, and the credentials within it are parsed.</span></span> <span data-ttu-id="7c4b0-205">Caso precise selecionar o arquivo de autorização em tempo de execução, manipule o ambiente do programa usando a função [os.Setenv](https://golang.org/pkg/os/#Setenv).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-205">If you need to select the authorization file at runtime, manipulate the program's environment using the [os.Setenv](https://golang.org/pkg/os/#Setenv) function.</span></span>

<span data-ttu-id="7c4b0-206">Para carregar as informações de autenticação, chame a função [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-206">To load the authentication information, call the [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile) function.</span></span> <span data-ttu-id="7c4b0-207">Ao contrário da autorização baseada em ambiente, a autorização baseada em arquivo exige um ponto de extremidade do recurso.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-207">Unlike environment-based authorization, file-based authorization requires a resource endpoint.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := NewAuthorizerFromFile(azure.PublicCloud.ResourceManagerEndpoint)
```

<span data-ttu-id="7c4b0-208">Para obter mais informações sobre como usar as entidades de serviço e como gerenciar suas permissões de acesso, consulte [Criar uma entidade de serviço com a CLI do Azure 2.0].</span><span class="sxs-lookup"><span data-stu-id="7c4b0-208">For more on using service principals and managing their access permissions, see [Create a service principal with Azure CLI 2.0].</span></span>

## <a name="use-device-token-authentication"></a><span data-ttu-id="7c4b0-209">Usar autenticação de token do dispositivo</span><span class="sxs-lookup"><span data-stu-id="7c4b0-209">Use device token authentication</span></span>

<span data-ttu-id="7c4b0-210">Caso queira que os usuários façam logon interativamente, a melhor maneira de oferecer essa capacidade é por meio da autenticação de token do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-210">If you want users to log in interactively, the best way to offer that capability is through device token authentication.</span></span> <span data-ttu-id="7c4b0-211">Esse fluxo de autenticação passa ao usuário um token para ser colado em um site de logon da Microsoft, onde eles, então, fazem logon com uma conta do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-211">This authentication flow passes the user a token to paste into a Microsoft login site, where they then log in with an Azure Active Directory (AAD) account.</span></span> <span data-ttu-id="7c4b0-212">Esse método de autenticação oferece suporte a contas que têm a autenticação multifator habilitada, ao contrário de autenticação padrão de nome de usuário/senha.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-212">This authentication method supports accounts that have multi-factor authentication enabled, unlike standard username/password authentication.</span></span>

<span data-ttu-id="7c4b0-213">Para usar uma autenticação de token do dispositivo, crie um autorizador [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) com a função [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-213">To use device token authentication, create a [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) authorizer with the [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig) function.</span></span> <span data-ttu-id="7c4b0-214">Chame o [Autorizador](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) no objeto resultante para iniciar o processo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-214">Call [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) on the resulting object to start the authentication process.</span></span> <span data-ttu-id="7c4b0-215">A autenticação de fluxo do dispositivo bloqueia a execução do programa até que todo o fluxo de autenticação seja concluído.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-215">Device flow authentication blocks program execution until the whole authentication flow is complete.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
deviceConfig := auth.NewDeviceFlowConfig(applicationID, tenantID)
authorizer, err := deviceConfig.Authorizer()
```

## <a name="use-an-authentication-client"></a><span data-ttu-id="7c4b0-216">Usar um cliente de autenticação</span><span class="sxs-lookup"><span data-stu-id="7c4b0-216">Use an authentication client</span></span>

<span data-ttu-id="7c4b0-217">Caso precise de um tipo específico de autenticação e esteja disposto que seu programa faça o trabalho de carregar informações de autenticação do usuário, você pode usar qualquer cliente que esteja de acordo com a interface [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig).</span><span class="sxs-lookup"><span data-stu-id="7c4b0-217">If you require a specific type of authentication and are willing to have your program do the work to load authentication information from the user, you can use any client that conforms to the [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig) interface.</span></span> <span data-ttu-id="7c4b0-218">Use um tipo que implemente essa interface quando você desejar um programa interativo, use arquivos de configuração especializados ou tenha um requisito que impeça o uso de outro método de autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-218">Use a type that implements this interface when you want an interactive program, use specialized configuration files, or have a requirement that prevents you from using another authentication method.</span></span>

> [!WARNING]
> <span data-ttu-id="7c4b0-219">Nunca use credenciais do Azure embutidas em código em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-219">Never hard-code Azure credentials into an application.</span></span> <span data-ttu-id="7c4b0-220">Colocar segredos em um binário de aplicativo facilita sua extração por um invasor, quer o aplicativo esteja em execução ou não.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-220">Putting secrets into an application binary makes it easier for an attacker to extract them, whether the application is running or not.</span></span> <span data-ttu-id="7c4b0-221">Isso coloca em risco todos os recursos do Azure para os quais as credenciais são autorizadas!</span><span class="sxs-lookup"><span data-stu-id="7c4b0-221">This puts all Azure resources the credentials are authorized for at risk!</span></span>

<span data-ttu-id="7c4b0-222">A tabela a seguir lista os tipos no SDK que estão de acordo com a interface `AuthorizerConfig`.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-222">The following table lists the types in the SDK that conform to the `AuthorizerConfig` interface.</span></span>

| <span data-ttu-id="7c4b0-223">Tipo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-223">Authentication type</span></span> | <span data-ttu-id="7c4b0-224">Tipo de autorizador</span><span class="sxs-lookup"><span data-stu-id="7c4b0-224">Authorizer type</span></span> |
|---------------------|-----------------------|
| <span data-ttu-id="7c4b0-225">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="7c4b0-225">Certificate-based authentication</span></span> | <span data-ttu-id="7c4b0-226">[ClientCertificateConfig]</span><span class="sxs-lookup"><span data-stu-id="7c4b0-226">[ClientCertificateConfig]</span></span> |
| <span data-ttu-id="7c4b0-227">Credenciais do cliente</span><span class="sxs-lookup"><span data-stu-id="7c4b0-227">Client credentials</span></span> | <span data-ttu-id="7c4b0-228">[ClientCredentialsConfig]</span><span class="sxs-lookup"><span data-stu-id="7c4b0-228">[ClientCredentialsConfig]</span></span> |
| <span data-ttu-id="7c4b0-229">MSI (Identidade do serviço gerenciado)</span><span class="sxs-lookup"><span data-stu-id="7c4b0-229">Managed Service Identity (MSI)</span></span> | <span data-ttu-id="7c4b0-230">[MSIConfig]</span><span class="sxs-lookup"><span data-stu-id="7c4b0-230">[MSIConfig]</span></span> |
| <span data-ttu-id="7c4b0-231">Nome de usuário/senha</span><span class="sxs-lookup"><span data-stu-id="7c4b0-231">Username/password</span></span> | <span data-ttu-id="7c4b0-232">[UsernamePasswordConfig]</span><span class="sxs-lookup"><span data-stu-id="7c4b0-232">[UsernamePasswordConfig]</span></span> |

[ClientCertificateConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCertificateConfig
[ClientCredentialsConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCredentialsConfig
[MSIConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#MSIConfig
[DeviceFlowConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig
[UsernamePasswordConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#UsernamePasswordConfig

<span data-ttu-id="7c4b0-237">Crie um autenticador com sua função `New` associada, depois chame `Authorize` no objeto resultante para realizar a autenticação.</span><span class="sxs-lookup"><span data-stu-id="7c4b0-237">Create an authenticator with its associated `New` function, and then call `Authorize` on the resulting object to perform authentication.</span></span> <span data-ttu-id="7c4b0-238">Por exemplo, para usar a autenticação baseada em certificado:</span><span class="sxs-lookup"><span data-stu-id="7c4b0-238">For example, to use certificate-based authentication:</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
certificateAuthorizer := auth.NewClientCertificateConfig(certificatePath, certificatePassword, clientID, tenantID)
authorizerToken, err := certificateAuthorizer.Authorize()
```
